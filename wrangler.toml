#:schema node_modules/wrangler/config-schema.json
name = "n8n-mcp-saas"
main = "src/index.ts"
compatibility_date = "2025-01-26"
workers_dev = true

# Custom Domain
routes = [
  { pattern = "n8n-management-mcp.node2flow.net", custom_domain = true }
]

# Observability
[observability]
enabled = true

# ============================================
# D1 Database Binding
# ============================================
# Create database: wrangler d1 create n8n-mcp-saas-db
# Apply schema: wrangler d1 execute n8n-mcp-saas-db --file=./schema.sql
[[d1_databases]]
binding = "DB"
database_name = "n8n-mcp-saas-db"
database_id = "705840e0-4663-430e-9f3b-3778c209e525"

# ============================================
# KV Namespace Binding (for rate limiting cache)
# ============================================
# Create KV: wrangler kv:namespace create "RATE_LIMIT_KV"
[[kv_namespaces]]
binding = "RATE_LIMIT_KV"
id = "45d5d994b649440ab34e4f0a3a5eaa66"

# ============================================
# Environment Variables (Secrets)
# ============================================
# Set secrets using:
# wrangler secret put JWT_SECRET
# wrangler secret put ENCRYPTION_KEY
#
# Generate secure secrets:
# node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

[vars]
ENVIRONMENT = "production"

# ============================================
# Development Environment
# ============================================
[env.dev]
name = "n8n-mcp-saas-dev"

[env.dev.vars]
ENVIRONMENT = "development"

# For local development, use:
# wrangler dev --local --persist

# ============================================
# Staging Environment
# ============================================
[env.staging]
name = "n8n-mcp-saas-staging"

[env.staging.vars]
ENVIRONMENT = "staging"
